{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>UniStay â€¢ Booking</title>

  <link rel="stylesheet" href="{% static 'css/header_1.css' %}">
  <link rel="stylesheet" href="{% static 'css/boys.css' %}">
  <link rel="stylesheet" href="{% static 'css/booking.css' %}">

  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

{% include 'partials/header.html' with active_page='bookings' %}

<section class="intro-banner">
  <div class="intro-content">
    <h1>Hostel Booking</h1>
    <p>Fill in your details below. Our team will contact you.</p>
  </div>
</section>

<section class="booking-wrapper">
{% if messages %}
  <div class="messages">
    {% for message in messages %}
      <p class="{{ message.tags }}">{{ message }}</p>
    {% endfor %}
  </div>
{% endif %}

<!-- ===================================================== -->
<!-- ðŸ”’ IF BOOKING EXISTS â†’ SHOW SUCCESS (PERMANENT) -->
<!-- ===================================================== -->
{% if existing_booking %}
<section class="booking-success">
  <div class="success-card">
    <h2>âœ… Booking Submitted Successfully</h2>

    <div class="success-details">
      <div>Name: <strong>{{ existing_booking.name }}</strong></div>
      <div>Email: <strong>{{ existing_booking.email }}</strong></div>
      <div>Usn: <strong>{{ existing_booking.usn }}</strong></div>
      <div>Phone: <strong>{{ existing_booking.phone }}</strong></div>
      <div>Hostel: <strong>{{ existing_booking.hostel_type }}</strong></div>
      <div>Year: <strong>{{ existing_booking.year }}</strong></div>
      <div>Pref 1: <strong>{{ existing_booking.pref_1 }}</strong></div>
      <div>Pref 2: <strong>{{ existing_booking.pref_2 }}</strong></div>
      <div>Pref 3: <strong>{{ existing_booking.pref_3 }}</strong></div>
    </div>
  </div>
</section>

<!-- ===================================================== -->
<!-- ðŸ“ ELSE â†’ SHOW FORM -->
<!-- ===================================================== -->
{% else %}
<form method="post" class="booking-form" id="bookingForm" novalidate>
  {% csrf_token %}
  <div class="booking-grid">
    <div class="form-group">
      <input type="text" name="name" placeholder="Full Name" required>
    </div>
    <div class="form-group">
      <input type="email" name="email" value="{{ request.user.email }}" readonly>
    </div>
    <div class="form-group">
      <input type="text" name="usn" id="usn" placeholder="Usn" required>
      <small class="error-text" id="usnError"></small>
    </div>

    <div class="form-group">
      <input type="tel" name="phone" id="phone" placeholder="Phone Number" required>
      <small class="error-text" id="phoneError"></small>
    </div>
    <div class="form-group">
      <input type="text" value="{{ hostel_type_display }}" readonly>
      <input type="hidden" name="hostel_type" value="{{ hostel_type }}">
    </div>
    <div class="form-group">
      <select name="year" required>
        <option value="" disabled selected>Select Year of Study</option>
        <option value="1">1st Year</option>
        <option value="2">2nd Year</option>
        <option value="3">3rd Year</option>
        <option value="4">4th Year</option>
      </select>
    </div>

    <div class="form-group">
      <select name="pref_1" required>
        <option value="" disabled selected>Preference 1</option>
        {% for v,l in hostels %}
          <option value="{{ v }}">{{ l }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group">
      <select name="pref_2" required>
        <option value="" disabled selected>Preference 2</option>
        {% for v,l in hostels %}
          <option value="{{ v }}">{{ l }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group">
      <select name="pref_3" required>
        <option value="" disabled selected>Preference 3</option>
        {% for v,l in hostels %}
          <option value="{{ v }}">{{ l }}</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <div class="booking-btn">
    <button type="submit" class="btn btn-accent">
      <i data-lucide="check-circle"></i> Submit Booking
    </button>
  </div>
</form>
{% endif %}

</section>

<footer>Â© 2025 UniStay â€¢ All Rights Reserved</footer>

<script src="{% static 'js/booking.js' %}"></script>
</body>
</html>
